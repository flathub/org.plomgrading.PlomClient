# SPDX-License-Identifier: FSFAP
# Copyright (C) 2022 Colin B. Macdonald
#
# Copying and distribution of this file, with or without modification,
# are permitted in any medium without royalty provided the copyright
# notice and this notice are preserved.  This file is offered as-is,
# without any warranty.

# Idea is to specify the available "manylinux" wheels for x86_64 and
# aarch64 to avoid building PyMuPDF from source (which would require
# MuPDF).  Inspired by an example by real-yfprojects:
# https://github.com/flatpak/flatpak-builder-tools/issues/296#issuecomment-1173037783
#
# I included the .tar.gz source as a fallback, but could be removed.

name: python3-pymupdf
buildsystem: simple
build-commands:
  - pip3 install --verbose --exists-action=i --no-index --find-links="file://${PWD}" --prefix=${FLATPAK_DEST} "pymupdf==1.20.1" --no-build-isolation
sources:
  - type: file
    url: https://pypi.io/packages/source/p/pymupdf/PyMuPDF-1.20.1.tar.gz
    sha256: 305c1a64b8fb2fd465e27cc8bdcbf0f64224f0ec6d7763e3f5f2ca6783136649
  - type: file
    url: https://files.pythonhosted.org/packages/b6/a3/bca132d4af5385187c7f78b1a926342a8d647dc78da7ba78ad7a90c9c495/PyMuPDF-1.20.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl
    sha256: 12167cd3a58f50b9e67600112834d588beeec400ffce06564b8f2bf2b8b8f9f7
    only-arches:
      - x86_64
  - type: file
    url: https://files.pythonhosted.org/packages/25/40/9c85e9f4c3ba6646605f4d0eb43cb37cac27954f511f9b2a98129283edbb/PyMuPDF-1.20.1-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl
    sha256: 524396cb72a361b1382ad6dbb7ad51b123b76cd98e88fafe46f96252ebb8a484
    only-arches:
      - aarch64
  - type: file
    url: https://files.pythonhosted.org/packages/d1/ab/3ad3c732ffa3ba07d6726021d4d9099c231ca2c108dc57e82fcdddc64cda/PyMuPDF-1.20.1-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl
    sha256: 743f1ee5ebdba51505d2c81e903dcc9f3903cb07ee99b4419daae1a355b75642
    only-arches:
      - x86_64
  - type: file
    url: https://files.pythonhosted.org/packages/b3/cf/dcfe97d72ba72244cbc1f5ee697535cd17f56ff2d04aa64d9ca1f9c87d4f/PyMuPDF-1.20.1-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl
    sha256: 7e95b7c867e4a6a8f2fd85c82cb0dc8fbb536eb1a6e9a9e33c8b3d68642c2782
    only-arches:
      - aarch64
  - type: file
    url: https://files.pythonhosted.org/packages/8e/a5/35f653f07e56ba353839db1a73b697fbbf2da0ae728990031fb910b0c02c/PyMuPDF-1.20.1-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl
    sha256: cab9da6ed5dbfe0c9ee0084330f8683b15d160c00e681e14f60a23a313f34376
    only-arches:
      - x86_64
  - type: file
    url: https://files.pythonhosted.org/packages/8d/f4/9a3f050b92934df88186db331ed36336270fb3ded5d4f0f2e9f7879c80c8/PyMuPDF-1.20.1-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl
    sha256: 06f5970f7851a97fbd0b7ea424ba44c150a7f6570a38fb582348098e51627c68
    only-arches:
      - aarch64
  - type: file
    url: https://files.pythonhosted.org/packages/46/ee/01aa35eb3a731977459e7b72cbc9eebb6db41dad048a3bc9a09913a96181/PyMuPDF-1.20.1-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl
    sha256: 134290580f2465ea638c7425cdc68ffd20b9e69b918fb8355e532603f3aad43f
    only-arches:
      - x86_64
  - type: file
    url: https://files.pythonhosted.org/packages/4b/ce/85d14b40c1641cd0b7e799ff0413903db256eea92c92317535d5206655bf/PyMuPDF-1.20.1-cp37-cp37m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl
    sha256: 435d7db1f7b20536ff2208ec53cf805f1bbd8bfb0e3515a494f33493ded61685
    only-arches:
      - aarch64
