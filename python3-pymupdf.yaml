# SPDX-License-Identifier: FSFAP
# Copyright (C) 2022-2023 Colin B. Macdonald
#
# Copying and distribution of this file, with or without modification,
# are permitted in any medium without royalty provided the copyright
# notice and this notice are preserved.  This file is offered as-is,
# without any warranty.

# Idea is to specify the available "manylinux" wheels for x86_64 and
# aarch64 to avoid building PyMuPDF from source (which would require
# MuPDF).  Inspired by an example by real-yfprojects:
# https://github.com/flatpak/flatpak-builder-tools/issues/296#issuecomment-1173037783
#
# I included the .tar.gz source as a fallback, but could be removed.

name: python3-pymupdf
buildsystem: simple
build-commands:
  - pip3 install --verbose --exists-action=i --no-index --find-links="file://${PWD}" --prefix=${FLATPAK_DEST} "pymupdf==1.21.1" --no-build-isolation
sources:
  - type: file
    url: https://pypi.io/packages/source/p/pymupdf/PyMuPDF-1.21.1.tar.gz
    sha256: f815741a435c62a0036bbcbf5fa6c533567bd69c5338d413714fc57b22db93e0
  - type: file
    url: https://files.pythonhosted.org/packages/e2/bb/76ce95d6c3d294304b458c2477ae64074f600db5a761c59534571ccc65e0/PyMuPDF-1.21.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl
    sha256: ff7d01cb563c3ca18880ba6a2661351f07b8a54f6599272be2e3568524e5e721
    only-arches:
      - x86_64
  - type: file
    url: https://files.pythonhosted.org/packages/73/cc/873d325a756bff12a49f315c2b561f9ad3421a92c79dd2ce643006847325/PyMuPDF-1.21.1-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl
    sha256: 06860a8e60ba14f25aac5db90803d59b1a2fdac24c2b65dc6f9876ff36df586e
    only-arches:
      - aarch64
  - type: file
    url: https://files.pythonhosted.org/packages/e0/27/83c843ef54f5c65874c844a77e216326eb5b2a2fcb08bd7cb0784fb759f9/PyMuPDF-1.21.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl
    sha256: e5273ff0c3bf08428ef956c4a5e5e0b475667cc3e1cb7b41d9f5131636996e59
    only-arches:
      - x86_64
  - type: file
    url: https://files.pythonhosted.org/packages/9c/90/4dcdb731e9aaecfa2f10300bf51f4f2d2079083819fd4a109a3e1d331338/PyMuPDF-1.21.1-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl
    sha256: 36181c4cb27740791d611d0224dd18ac78e23a1f06aa2151394c5b9194b4f885
    only-arches:
      - aarch64
  - type: file
    url: https://files.pythonhosted.org/packages/b6/74/7883ec5bb17c4b11ed735e649e097ca62a10315b87ade689cf0149b577df/PyMuPDF-1.21.1-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl
    sha256: 2fbb96336c5cc065f6e5359f034a689e4d64ca7697dc5965b03f105b2ecb7ba1
    only-arches:
      - x86_64
  - type: file
    url: https://files.pythonhosted.org/packages/21/61/6a82ea468ed8e2ee395acf82cb54baffa7bd09ec45a4eac834a390a86581/PyMuPDF-1.21.1-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl
    sha256: 2bb5f9ce33054ebfbf63c41e68606d51e3ad5d85def0af5ebb6f0dd276e61037
    only-arches:
      - aarch64
  - type: file
    url: https://files.pythonhosted.org/packages/de/d3/7b21aabd0a59ea72aedbec8d90c6c49068e17c8484ad15ce4266d5c59d7f/PyMuPDF-1.21.1-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl
    sha256: 0c85efbc08c83c8d91ae1cc7bb7e06c7cd7e203e9d0ed806ff22db173999f30c
    only-arches:
      - x86_64
  - type: file
    url: https://files.pythonhosted.org/packages/1e/66/b872296c47c7a549bfeb33a9580fd1a5fb8f790da0f6573f333be232df95/PyMuPDF-1.21.1-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl
    sha256: 0b08b6afbb656f0e4582a8ee44c2ce0ab6235bb81830ec92d79f6e4893db639c
    only-arches:
      - aarch64
