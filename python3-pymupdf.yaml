# SPDX-License-Identifier: FSFAP
# Copyright (C) 2022 Colin B. Macdonald
#
# Copying and distribution of this file, with or without modification,
# are permitted in any medium without royalty provided the copyright
# notice and this notice are preserved.  This file is offered as-is,
# without any warranty.

# Idea is to specify the available "manylinux" wheels for x86_64 and
# aarch64 to avoid building PyMuPDF from source (which would require
# MuPDF).  Inspired by an example by real-yfprojects:
# https://github.com/flatpak/flatpak-builder-tools/issues/296#issuecomment-1173037783
#
# I included the .tar.gz source as a fallback, but could be removed.

name: python3-pymupdf
buildsystem: simple
build-commands:
  - pip3 install --verbose --exists-action=i --no-index --find-links="file://${PWD}" --prefix=${FLATPAK_DEST} "pymupdf==1.20.2" --no-build-isolation
sources:
  - type: file
    url: https://pypi.io/packages/source/p/pymupdf/PyMuPDF-1.20.2.tar.gz
    sha256: 02eedf01f57c6bafb5e8667cea0088a2d2522643c47100f1908bec3a68a84888
  - type: file
    url: https://files.pythonhosted.org/packages/57/a7/e3f2ee590766aa8c923b9580ee7dc9e2c5cec3b1f00456e66ec8a47192d0/PyMuPDF-1.20.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl
    sha256: 73dbf73ac1c5cbf99dec903c98bc18eb30c8fe1d703ec5531296a5308700f001
    only-arches:
      - x86_64
  - type: file
    url: https://files.pythonhosted.org/packages/34/64/1fddfe6b4df8084dbd74d86299ab6083feecaf006ae03f3b68bbf782ac6e/PyMuPDF-1.20.2-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl
    sha256: 2a82438b44723e7dcb47d156cf0299fcf3d09e970ee469081c3f9d79b8c40ce3
    only-arches:
      - aarch64
  - type: file
    url: https://files.pythonhosted.org/packages/68/29/6e7a908db60d4d653ae68553ef2faac3943204d94efdd63cc0aa1e37fa3b/PyMuPDF-1.20.2-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl
    sha256: 5c0ee0df665849f8686981fcc8f836afac2302bb6a7aaf330e73fd5694017d9d
    only-arches:
      - x86_64
  - type: file
    url: https://files.pythonhosted.org/packages/f8/31/037e95c81f98c8e3011f159fd486cdf05ecc6706721cc430a116c935acb4/PyMuPDF-1.20.2-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl
    sha256: bddf7d617fba1b345d9aee8d533888e340ffa3f784910453608bc5541089023c
    only-arches:
      - aarch64
  - type: file
    url: https://files.pythonhosted.org/packages/1a/92/8944ffdccc43fcb775caef8d3762e86136d758102f830a319af5fda1c467/PyMuPDF-1.20.2-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl
    sha256: 9f2897fb4160b5fe2f80739ca9e101677e5694b5dcfda8026b0eb0b7e2db5615
    only-arches:
      - x86_64
  - type: file
    url: https://files.pythonhosted.org/packages/2e/56/454f1e47e4fb4e0f857e817e068741b5c2c3446e9a5eb1c178ae87c6261d/PyMuPDF-1.20.2-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl
    sha256: 7d29a7db4b15dcb7632bb6afa197f12f95244ab15f7c73ccb219e3f7df4e79fa
    only-arches:
      - aarch64
  - type: file
    url: https://files.pythonhosted.org/packages/fc/e8/5e9a0a148ef2e88ef40af0e124efd05cdf4f17f9be61cba7d38241fca286/PyMuPDF-1.20.2-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl
    sha256: 6c50b8408dbbb921cfce7145ac0ae0e150955f9b2deed8cdddf03e830ca1e6a2
    only-arches:
      - x86_64
  - type: file
    url: https://files.pythonhosted.org/packages/a7/37/7eac8ffdf529d880ce224bfb922544878905dc8fb9367bb909640fe1a89e/PyMuPDF-1.20.2-cp37-cp37m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl
    sha256: 5824103cf2ea3b492cb5b3c66ab16d61db65363ebdfb7ed28a2af93cb48dee4f
    only-arches:
      - aarch64
