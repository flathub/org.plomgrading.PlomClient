# SPDX-License-Identifier: FSFAP
# Copyright (C) 2020-2021 Colin B. Macdonald
#
# Copying and distribution of this file, with or without modification,
# are permitted in any medium without royalty provided the copyright
# notice and this notice are preserved.  This file is offered as-is,
# without any warranty.

app-id: org.plomgrading.PlomClient
runtime: org.kde.Platform
runtime-version: '5.15'
sdk: org.kde.Sdk
command: PlomClient
finish-args:
  - --socket=wayland
  - --socket=x11
  - --share=ipc
  - --device=dri
  - --share=network
# note pyqt5 has hardcoded python3.8 and does not use pip
modules:
  - pyqt5.json
  - python3-appdirs.json
  - python3-toml.json
  - python3-requests-toolbelt.json
  - python3-wheel.json

  - name: Plom
    buildsystem: simple
    build-commands:
      - pip3 install --prefix=$FLATPAK_DEST --no-deps --no-build-isolation .
      - install -D PlomClient.workaround $FLATPAK_DEST/bin/PlomClient
    sources:
      - type: archive
        url: https://files.pythonhosted.org/packages/a4/c2/b1aec8e87be662209c9f154296471f137ed6eda0e277880b8001dfbf1c7c/plom-0.5.21.tar.gz
        sha256: 0f4a51cc29496af6b3b819e10ed60da59c5231dbc3c77c344901ea1e51cdb27b
      - type: file
        path: PlomClient.workaround
